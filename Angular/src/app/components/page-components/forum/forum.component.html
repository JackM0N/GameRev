
<div class="p-8 bg-[#1b1b1b] min-h-screen text-white font-arcade">
  <!-- Breadcrumb Navigation -->
  <nav class="breadcrumb flex space-x-2 text-sm mb-4" *ngIf="path && path.length > 1">
    <ng-container *ngFor="let segment of path; let i = index">
      <a *ngIf="i < path.length - 1" [href]="'/forum/' + segment.id" class="text-cyan-400 hover:text-cyan-300 font-bold">
        {{ segment.forumName }}
      </a>
      <span *ngIf="i < path.length - 1" class="text-gray-500"> &gt; </span>
      <span *ngIf="i === path.length - 1" class="font-bold text-gray-300">{{ segment.forumName }}</span>
    </ng-container>
  </nav>

  <!-- Forum Header with Button Aligned and Title Centered -->
  <header class="forum-header mt-6 relative bg-[#222222] shadow-lg p-6 border border-[#00CFFF]">
    <!-- Button to View All Requests (Positioned on the right) -->
    <div class="absolute right-3 top-3" *ngIf="this.authService.isAuthenticated() && this.authService.isAdmin()">
      <button class="synthwaveButton max-w-sm" (click)="routeToRequests()">
        View All Requests
      </button>
    </div>

    <!-- Forum title and description (Centered) -->
    <div class="text-center">
      <h1 class="text-4xl font-bold text-[#E5E5E5]">{{ currentForum?.forumName }}</h1>
      <p class="text-lg text-[#B0B0B0] mt-2">{{ currentForum?.description }}</p>
    </div>
  </header>

  <!-- Forum Table -->
  <div *ngIf="currentForum" [hidden]="noSubForums" class="mt-8 bg-[#222222] shadow-lg overflow-hidden border border-[#00CFFF]">
    <div class="px-6 py-4">
      <h2 class="text-3xl font-bold text-[#E5E5E5] mb-4">Subforums</h2>
      <table class="w-full border-collapse">
        <thead class="bg-[#1A1A1A] text-[#E5E5E5]">
          <tr>
            <th class="p-4 border-b border-[#00CFFF]">Subforum</th>
            <th class="p-4 border-b border-[#00CFFF]">Posts</th>
            <th class="p-4 border-b border-[#00CFFF]">Last Post</th>
            <th class="p-4 border-b border-[#00CFFF]" *ngIf="this.authService.isAuthenticated() && this.authService.isAdmin()">Actions</th>
          </tr>
        </thead>

        <tbody>
          <!-- Subforum Rows -->
          <tr *ngFor="let subforum of subForumList" class="hover:bg-[#333333]">
            <td class="p-4 border-b border-[#00CFFF]">
              <a (click)="navigateToSubforum(subforum.id)" class="text-cyan-400 hover:text-cyan-300 font-semibold cursor-pointer">
                {{ subforum.forumName }}
              </a>
              <p class="text-[#B0B0B0] mt-1">{{ subforum.description }}</p>
            </td>
            <td class="p-4 border-b border-[#00CFFF]">{{ subforum.postCount }} Post(s)</td>
            <td *ngIf="subforum.lastPost" class="p-4 border-b border-[#00CFFF]">
              <p class="text-[#E5E5E5]">Last post by {{ subforum.lastPost.nickname }}</p>
              <p>
                in <a (click)="navigateToLastPost(subforum.lastPost)" class="text-cyan-400 hover:text-cyan-300 font-semibold cursor-pointer">
                  {{ subforum.lastPost.title }}
                </a>
              </p>
              <p class="text-[#B0B0B0]">on {{ formatDateTime(subforum.lastPost.last_response_date) }}</p>
            </td>
            <td *ngIf="!subforum.lastPost" class="p-4 border-b border-[#00CFFF]">
              <p class="text-[#B0B0B0]">No interactions yet</p>
            </td>

            <!-- Actions column with edit button -->
            <td class="p-4 border-b border-[#00CFFF]" *ngIf="this.authService.isAuthenticated() && this.authService.isAdmin()">
              <button class="bg-yellow-500 text-white px-3 pb-1 pt-2 hover:bg-yellow-600 mr-2" (click)="openEditSubforumDialog(subforum)">
                <i class="material-icons">edit</i>
              </button>

              <button class="bg-red-500 text-white px-3 pb-1 pt-2 hover:bg-red-600" (click)="openDeleteSubforumDialog(subforum)">
                <i class="material-icons">delete</i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Add new subforum -->
  <div class="mt-6" *ngIf="this.authService.isAuthenticated() && this.authService.isAdmin()">
    <button class="synthwaveButton" (click)="openAddSubforumDialog()">Add Subforum</button>
  </div>

  <!-- Paginator for Forums -->
  <div [hidden]="totalSubforums < 5">
    <mat-paginator
      #paginator
      [length]="totalSubforums"
      [pageSize]="5"
      [pageSizeOptions]="[5, 10, 20]"
      showFirstLastButtons>
    </mat-paginator>
  </div>

  <!-- Forum Posts List -->
  <div class="mt-2">
    <app-forum-post-list [currentForumId]="forumId" class="m-8"></app-forum-post-list>
  </div>
</div>
